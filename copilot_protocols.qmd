---
abstract: This document outlines **mandatory** protocols for using GitHub Copilot in technical work, explains how to use the GPID prompt files that implement these protocols, and provides guidance on installation, usage, and maintenance.
execute:
  eval: true
bibliography: AI.bib
---

# Mandatory Protocols for Using GitHub Copilot in Technical Work {#sec-copilot-protocols}

## Purpose and Principles 

```{r}
#| echo: false
#| results: false
source("R/helpers.R")

```


GitHub Copilot is a powerful assistant that can increase productivity, generate boilerplate code quickly, and support experimentation. However, Copilot is not a substitute for engineering judgment, critical thinking, or expertise in R/Stata. without discipline, Copilot can also introduce inefficiency, unnecessary complexity, hallucinated dependencies, and silent errors.
This document establishes:

1. **Mandatory protocols** for how Copilot must be used in all GPID technical work.  
2. **A unified system of Copilot prompt files**, named `gpid-proto-*`, which encode these protocols into reproducible steps.  
3. **Clear instructions** on how to install, update, and use these prompt files across all GPID projects.

Team leads will verify compliance during code reviews.


## GPID Copilot Prompt System

To ensure consistency, the GPID team uses **shared Copilot prompt files** stored in a central repository.  
These prompt files automate the workflows described in this document.

### What Are GPID Prompt Files?

Prompt files are `.prompt.md` files that define reusable Copilot commands.  
They appear in VS Code or Positron when you type `/` in Copilot Chat.

Each GPID protocol prompt begins with the prefix `gpid-proto-`

Examples:

- `/gpid-proto-start-task`  
- `/gpid-proto-explain-code`  
- `/gpid-proto-document-code`  
- `/gpid-proto-review-efficiency`  
- `/gpid-proto-tests-checklist`  
- `/gpid-proto-deps-risk`  
- `/gpid-proto-self-critique`  
- `/gpid-proto-wrap-task`

These commands help you follow the mandatory protocols with minimal effort.


### Where the Prompt Files Live

The shared prompts are stored in the repository [GPID-WB/copilot-prompts](https://github.com/GPID-WB/copilot-prompts).  The prompt files for these protocols are in the folder prompts/

```
prompts/
gpid-proto-start-task.prompt.md
gpid-proto-explain-code.prompt.md
gpid-proto-document-code.prompt.md
gpid-proto-review-efficiency.prompt.md
gpid-proto-tests-checklist.prompt.md
gpid-proto-deps-risk.prompt.md
gpid-proto-self-critique.prompt.md
gpid-proto-wrap-task.prompt.md

```

These prompts are **global tools** used in *every* GPID technical project.


### One-Time Installation (Per Developer)

Each team member must clone the prompts repository locally. For the rest of this document, we assume you clone it to:

```
C:\Users\<USERNAME>\OneDrive - WBG\GPID-team\copilot-prompts
```

### Registering Prompt Files in VS Code / Positron

After cloning, you must tell Copilot where to find the shared prompts by modifying the **user settings**. This can by done in multiple ways, but we recommend the following:

1. In positron, open settings via the gear icon in the lower left corner or by hitting `Ctrl + ,`.
2. Search for "prompt files location" (without quotes).
3. Hit "add item" and add the full path to the `prompts` folder in your local clone of the repository adding the `protocols/` subfolder.
![](images/prompt_files_location.png) 
4. Restart Positron.


NOW Typing `/` in Copilot Chat will now show all GPID protocol prompts.


### Updating Prompt Files

Whenever a prompt file changes, you will be notified. However, the best practice is to regularly update your local copy. You can do it by opening the `copilot-prompts` folder in a terminal and running `git pull`, opening the whole folder in Positron and VScode and sync the changes or by using script similar to this:

```bash
cd "C:\Users\USERNAME\OneDrive - WBG\GPID-team\copilot-prompts"
git pull
```

## The GPID Protocol Prompts

The following sections describe each mandatory protocol and the corresponding `gpid-proto-*` prompt that should be used.

Using the prompts is simple. You just need to type the prompt command in Copilot Chat.

**Example:**

```
/gpid-proto-start-task
```

Copilot will ask for the necessary information and then guide you through the protocol.


### Protocol  {{< protocol >}} — Documenting Your Work With Copilot {.unnumbered}

**Prompt:**

```
/gpid-proto-start-task
```

::: {.callout-note collapse="true" title="gpid-proto-deps-risk"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-deps-risk.prompt.md")

```

:::


#### Purpose {.unnumbered}

Every Copilot-assisted task must produce a clear, transparent trail of:

* What was done
* Why decisions were made
* What dependencies were added or removed
* How the final code works

#### What It Does {.unnumbered}

When you run `/gpid-proto-start-task`, Copilot:

1. Asks you for:

   * **Task name**
   * **Short description**

2. Logs these clearly and begins a **running summary** of:

   * key prompts
   * major decisions
   * assumptions
   * dependencies added/removed

3. Keeps the summary alive throughout the task.

You do **not** need to structure this manually — the prompt enforces consistency.

---

### Protocol  {{< protocol >}} — Making the Code Understandable {.unnumbered}

**Prompts:**

```
/gpid-proto-explain-code
/gpid-proto-document-code
```



#### Purpose {.unnumbered}

Copilot may generate correct code, but not always readable code.
These prompts ensure that the logic, intention, and structure are thoroughly documented.

#### What They Do  {.unnumbered}

##### `/gpid-proto-explain-code` {.unnumbered}

* Asks what function/file you want explained
* Produces a **step-by-step technical explanation**
* Lists assumptions
* Identifies failure points

::: {.callout-note collapse="true" title="gpid-proto-explain-code"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-explain-code.prompt.md")

```

:::


##### `/gpid-proto-document-code` {.unnumbered}

* Adds in-code comments (the “what” and the “why”)
* Adds full Roxygen2 documentation (for R code)
* Produces a plain-language explanation for the task summary

::: {.callout-note collapse="true" title="gpid-proto-document-code"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-document-code.prompt.md")

```

:::




---

### Protocol  {{< protocol >}} — Code Review and Efficiency Check {.unnumbered}

**Prompt:**

```
/gpid-proto-review-efficiency
```

::: {.callout-note collapse="true" title="gpid-proto-review-efficiency"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-review-efficiency.prompt.md")

```

:::



#### Purpose {.unnumbered}

Before testing, every piece of Copilot-generated code must undergo an efficiency audit.

#### What It Does {.unnumbered}

The prompt reviews code for:

* redundant logic
* unnecessary copies
* over-nested structures
* unused variables
* dependency creep
* overly complex or fragile patterns

And provides clear, actionable improvements.

---

### Protocol  {{< protocol >}} — Testing and Edge Cases {.unnumbered}

**Prompt:**

```
/gpid-proto-tests-checklist
```

::: {.callout-note collapse="true" title="gpid-proto-tests-checklist"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-tests-checklist.prompt.md")

```

:::


#### Purpose {.unnumbered}

No Copilot-generated code is accepted without thorough testing.

#### What It does {.unnumbered}

1. A **validation checklist**
2. `testthat` unit tests (for R)
3. Stata assertions (if needed)
4. Optional performance tests

All structured for direct inclusion in your PR.

---

### Protocol  {{< protocol >}} — Dependencies, Risks, and Safety {.unnumbered}

**Prompt:**

```
/gpid-proto-deps-risk
```

::: {.callout-note collapse="true" title="gpid-proto-deps-risk"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-deps-risk.prompt.md")

```

:::



#### Purpose {.unnumbered}

Ensure that dependencies are justified, safe, and aligned with team standards.

#### What It Does {.unnumbered}

* Lists all dependencies
* Explains why each is needed
* Flags unnecessary packages
* Checks compatibility with `data.table`, `collapse`, and `rlang`
* Identifies unsafe patterns (I/O, file paths, etc.)

---

### Protocol  {{< protocol >}} — Self-Critique and Robustness Review {.unnumbered}

**Prompt:**

```
/gpid-proto-self-critique
```

::: {.callout-note collapse="true" title="gpid-proto-self-critique"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-self-critique.prompt.md")

```

:::


#### Purpose {.unnumbered}

Copilot is surprisingly good at critiquing its own work when prompted correctly.

This step often finds issues humans miss.

#### What It Does {.unnumbered}

* Reviews code as if performing a formal code review
* Identifies inefficiencies
* Points out risky assumptions
* Suggests simplifications
* Produces a concise summary of strengths, risks, and recommended improvements

---

### Protocol  {{< protocol >}} — Producing the Final Validation Bundle {.unnumbered}

**Prompt:**

```
/gpid-proto-wrap-task TASK_NAME
```

::: {.callout-note collapse="true" title="gpid-proto-wrap-task"}

```{r}
#| echo: false
#| results: asis
#| code-fold: true
embed_gpid_prompt("gpid-proto-wrap-task.prompt.md")

```

:::



#### Purpose {.unnumbered}

Every Copilot-assisted task ends with a **final Markdown summary** stored under:

```
copilot_logs/TASK_NAME.md
```

#### What It Does {.unnumbered}

* Task overview
* Step-by-step technical explanation
* Plain-language overview
* In-code comments summary
* Roxygen2 documentation summary
* Validation checklist
* Unit tests and edge cases
* Error-handling strategy
* Dependency and risk analysis
* Self-critique findings
* Remaining TODOs

This file must be included in your PR.


## Final Reminder: You Are the Author


**The code produced by Copilot is ultimately your responsibility.**

• **Authorship means accountability**: When you commit Copilot-assisted code, you are claiming authorship of it. This means you're responsible for its correctness, efficiency, and maintainability.

• **Review is mandatory**: Skipping the efficiency review puts the burden on your teammates during code review, slows down development, and can introduce bugs or performance issues that are hard to trace later.

• **Use Copilot as a tool, not a replacement**: Copilot accelerates your work, but it cannot replace your engineering judgment. You must understand, evaluate, and refine everything it produces.

**Bottom line:** If you wouldn't put your name on it as-is, don't commit it yet. Clean it up first.
